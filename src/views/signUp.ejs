<%- include('partials/header', { title: 'Registrarse' }) %>

<div class="row" style="margin-top: 40px;">
  <div class="col s12 m8 offset-m2">
    <div class="card">
      <div class="card-content">
        <span class="card-title center-align">Crear Cuenta</span>

        <form id="signup-form">
          <div class="row">
            <div class="col s12 m6">
              <div class="input-field">
                <i class="material-icons prefix">person</i>
                <input id="name" name="name" type="text" required />
                <label for="name">Nombre</label>
              </div>
            </div>
            <div class="col s12 m6">
              <div class="input-field">
                <i class="material-icons prefix">person_outline</i>
                <input id="lastName" name="lastName" type="text" required />
                <label for="lastName">Apellido</label>
              </div>
            </div>
          </div>

          <div class="row">
            <div class="col s12 m6">
              <div class="input-field">
                <i class="material-icons prefix">email</i>
                <input id="email" name="email" type="email" required />
                <label for="email">Email</label>
              </div>
            </div>
            <div class="col s12 m6">
              <div class="input-field">
                <i class="material-icons prefix">phone</i>
                <input id="phoneNumber" name="phoneNumber" type="tel" required />
                <label for="phoneNumber">Teléfono</label>
              </div>
            </div>
          </div>

          <div class="row">
            <div class="col s12 m6">
              <div class="input-field">
                <i class="material-icons prefix">cake</i>
                <input id="birthdate" name="birthdate" type="date" required />
                <label for="birthdate">Fecha de Nacimiento</label>
              </div>
            </div>
            <div class="col s12 m6">
              <div class="input-field">
                <i class="material-icons prefix">lock</i>
                <input id="password" name="password" type="password" required />
                <label for="password">Contraseña</label>
              </div>
            </div>
          </div>

          <div class="center-align">
            <button class="btn waves-effect waves-light btn-large" type="submit">
              <i class="material-icons left">person_add</i>
              Crear Cuenta
            </button>
          </div>

          <div class="center-align" style="margin-top: 20px;">
            <p>¿Ya tienes cuenta? <a href="/signIn">Inicia sesión aquí</a></p>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const form = document.getElementById('signup-form');
    
    form.addEventListener('submit', async function(e) {
        e.preventDefault();
        
        const formData = new FormData(form);
        const data = {
            name: formData.get('name'),
            lastName: formData.get('lastName'),
            email: formData.get('email'),
            phoneNumber: formData.get('phoneNumber'),
            birthdate: formData.get('birthdate'),
            password: formData.get('password')
        };
        
        if (!data.email || !data.password || !data.name || !data.lastName) {
            auth.showMessage('Campos requeridos: email, password, nombre y apellido', 'error');
            return;
        }
        
        await auth.handleSignUp(data);
    });
});
</script>

<%- include('partials/footer') %>
